@namespace Tavenem.Blazor.Framework

@typeparam TListItem

@inherits DraggableDropTarget<TListItem, TListItem>

@if (SeparatorBefore)
{
    <hr />
}
@if (Item is not null && ElementList?.ItemIsCollapsible?.Invoke(Item) == true)
{
    <Collapse Class="@CollapseClass"
              Style="@Style"
              Title="@(ChildContent is null ? Item?.ToString() : null)"
              TitleIsToggle="true">
        <TitleContent>@ChildContent</TitleContent>
        <ChildContent>
            @if (Item is not null)
            {
                if (ElementList?.CollapsibleTemplate is null)
                {
                    <span>@(Item?.ToString())</span>
                }
                else
                {
                    @ElementList.CollapsibleTemplate(Item)
                }
            }
        </ChildContent>
    </Collapse>
}
else
{
    <div class="@CssClass"
         style="@CssStyle"
         draggable="@Draggable"
         @onclick="OnClickAsync"
         @ondragstart="OnDragStart"
         @ondragend="OnDragEndAsync"
         @ondragenter="OnDragEnter"
         @ondragleave="OnDragLeave"
         ondragover="event.preventDefault();event.dataTransfer.dropEffect='move'"
         @ondrop="OnDropAsync">
        @if (!string.IsNullOrWhiteSpace(IconName))
        {
            <span class="@IconClassName">@IconName</span>
        }
        else if (ElementList is not null && ElementList.SelectionType != SelectionType.None)
        {
            <div style="display:inline-block;width:1.5em">&nbsp;</div>
        }
        @if (ChildContent is null)
        {
            <span>@(Item?.ToString())</span>
        }
        else
        {
            @ChildContent
        }
    </div>
}
@if (SeparatorAfter)
{
    <hr />
}
